(this.webpackJsonpstatic=this.webpackJsonpstatic||[]).push([[0],{31:function(e,t,n){},33:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),r=n(23),c=n.n(r),o=n(11),i=(n(30),n(31),n(2)),l=n.n(i),u=n(7),j=n(4),m=(n(33),n(0));function b(e){var t=e.roomList.map((function(t,n){return Object(m.jsx)("li",{className:"btn-group-vertical",style:{padding:"10px"},children:Object(m.jsxs)("button",{value:t.id,className:"room-list-buttons",type:"button",onClick:e.fetchMessagesForThatRoom,children:["# ",t.name]})},t.id)}));return Object(m.jsx)("aside",{style:{width:"25%",display:"flex",flexDirection:"column",alignItems:"flex-start"},children:Object(m.jsx)("ul",{children:t})})}var d=n(18),p=n(6),h=n.n(p);function f(e){var t=Object(s.useState)({name:""}),n=Object(j.a)(t,2),a=n[0],r=n[1];function c(){return c=Object(u.a)(l.a.mark((function t(n){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={name:n},t.next=3,fetch("/api_v1/rooms/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(s)});case 3:a=t.sent,e.setRoomList([].concat(Object(d.a)(e.roomList),[s])),a.ok;case 6:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}return Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(e){c.apply(this,arguments)}(a)},className:"new-room-form",children:[Object(m.jsx)("label",{htmlFor:"new-room"}),Object(m.jsx)("input",{type:"text",name:"name-for-newroom",placeholder:"New Room",onChange:function(e){r(e.target.value)}}),Object(m.jsx)("button",{className:"room-add-button",type:"submit",children:"+"})]})})}var x=n(12);function O(e){var t,n=Object(s.useState)(null),a=Object(j.a)(n,2),r=a[0],c=a[1],o=Object(s.useState)(!1),i=Object(j.a)(o,2),b=i[0],d=i[1];function p(e){return f.apply(this,arguments)}function f(){return(f=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("api_v1/messages/".concat(t.target.value,"/"),{method:"DELETE",headers:{"X-CSRFToken":h.a.get("csrftoken")}}).then((function(e){if(!e.ok)throw new Error("Oops, something went wrong!",e.status);t.target.parentNode.remove()}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(u.a)(l.a.mark((function t(n,s){var a,o,i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a={text:r,chat_room:e.room},o={method:"PUT",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(a)},t.next=5,fetch("/api_v1/messages/".concat(b,"/"),o);case 5:if(i=t.sent){t.next=10;break}console.log(i),t.next=15;break;case 10:return t.next=12,i.json();case 12:u=t.sent,c(Object(x.a)(Object(x.a)({},e.message),{},{data:u})),d(!1);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("h3",{children:["# ",e.currentRoom.name]}),Object(m.jsxs)("ul",{children:[b&&Object(m.jsxs)("form",{onSubmit:function(e,t){return O.apply(this,arguments)},children:[Object(m.jsx)("input",{type:"text",name:"newText",value:e.id,onChange:function(e){c(e.target.value)}}),Object(m.jsx)("button",{type:"submit",children:"Update"})]}),null===(t=e.messageList)||void 0===t?void 0:t.map((function(e){return Object(m.jsxs)("li",{children:[Object(m.jsxs)("p",{style:{padding:"10px"},value:e.id,children:[e.username,": ",e.text]}),Object(m.jsx)("button",{type:"button",value:e.id,onClick:function(){return d(e.id)},children:"Edit"}),Object(m.jsx)("button",{type:"click",className:"deletebutton",value:e.id,onClick:p,children:"Delete"})]},e.id)}))]})]})}function v(e){var t=Object(s.useState)({text:""}),n=Object(j.a)(t,2),a=n[0],r=n[1];function c(){return c=Object(u.a)(l.a.mark((function t(n){var s,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log({text:n}),s={text:n,chat_room:e.currentRoom.id},t.next=4,fetch("/api_v1/messages/",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(s)});case 4:a=t.sent,console.log({response:a}),e.setMessageList([].concat(Object(d.a)(e.messageList),[s])),a.ok;case 8:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}return Object(m.jsxs)("div",{className:"message-form-container",children:[Object(m.jsx)("label",{htmlFor:"sendingmessages"}),Object(m.jsxs)("form",{onSubmit:function(t){t.preventDefault(),function(e){c.apply(this,arguments)}(a,e.roomList)},children:[Object(m.jsx)("input",{onChange:function(e){r(e.target.value)},type:"text",placeholder:"Write a message"}),Object(m.jsx)("button",{className:"send-button",type:"submit",children:"Send"})]})]})}var g=n(14);function y(e){var t=Object(s.useState)(null),n=Object(j.a)(t,2),a=n[0],r=n[1],c=function(t){var n=t.target,s=n.name,a=n.value;e.setUser((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(g.a)({},s,a))}))};return Object(m.jsxs)("form",{className:"mt-3 container col-6",onSubmit:function(t){t.preventDefault(),e.user.password1!==e.user.password2?r("Passwords do not match!"):e.handleRegistration(e.user)},children:[Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"username",children:"Username"}),Object(m.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"Enter username.",required:!0,name:"username",onChange:c,value:e.user.username})]}),Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"email",children:"Email"}),Object(m.jsx)("input",{type:"email",className:"form-control",id:"email",placeholder:"Enter email.",required:!0,name:"email",onChange:c,value:e.user.email})]}),Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"password1",children:"Password"}),Object(m.jsx)("input",{type:"password",className:"form-control",id:"password1",placeholder:"Enter password.",required:!0,name:"password1",onChange:c,value:e.user.password1})]}),Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"password2",children:"Confirm your password"}),Object(m.jsx)("input",{type:"password",className:"form-control",id:"password2",placeholder:"Re-enter your password.",required:!0,name:"password2",onChange:c,value:e.user.password2}),Object(m.jsx)("span",{className:"text-danger",children:a})]}),Object(m.jsx)("button",{type:"submit",className:" mt-3",children:"Register"})]})}function w(e){var t=Object(s.useState)({username:"",password:""}),n=Object(j.a)(t,2),a=n[0],r=n[1],c=function(e){var t=e.target,n=t.name,s=t.value;r((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(g.a)({},n,s))}))};return Object(m.jsxs)("form",{className:"mt-3 container col-4",onSubmit:function(t){t.preventDefault(),e.handleLogin(a),e.history.push("/chat")},children:[Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"username",children:"Username"}),Object(m.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"Enter username.",required:!0,name:"username",onChange:c,value:a.username})]}),Object(m.jsxs)("div",{className:"form-group text-left mb-3",children:[Object(m.jsx)("label",{htmlFor:"password",children:"Password"}),Object(m.jsx)("input",{type:"password",className:"form-control",id:"password",placeholder:"Re-enter your password.",required:!0,name:"password",onChange:c,value:a.password}),Object(m.jsx)("span",{className:"text-danger",children:e.error})]}),Object(m.jsx)("button",{type:"submit",className:" mt-3",children:"Login"})]})}var k=n(3);function N(e){return Object(m.jsx)("nav",{className:"navbar navbar-expand-lg prim-nav-container",children:Object(m.jsx)("div",{className:"container",children:Object(m.jsx)("div",{className:"collapse navbar-collapse",id:"navbarResponsive",children:Object(m.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(m.jsx)("li",{children:Object(m.jsx)(o.b,{className:"navbar-brand",to:"/",children:"The Chat Room"})}),Object(m.jsx)("li",{className:"nav-item secondary-nav-item p-3",children:Object(m.jsx)(o.b,{to:"/register",children:"Register"})}),Object(m.jsx)("li",{className:"nav-item secondary-nav-item p-3",children:Object(m.jsx)(o.b,{to:"/login",children:"Login"})}),Object(m.jsx)("li",{className:"nav-item secondary-nav-item p-3",children:Object(m.jsx)(o.b,{to:"/chat",children:"Chat"})})]})})})})}var S=function(){var e=Object(s.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)([]),c=Object(j.a)(r,2),o=c[0],i=c[1],d=Object(s.useState)({username:"",email:"",password1:"",password2:""}),p=Object(j.a)(d,2),x=p[0],g=p[1],S=Object(s.useState)({name:"",id:null}),C=Object(j.a)(S,2),T=C[0],R=C[1],F=Object(s.useState)(null),L=Object(j.a)(F,2),E=L[0],P=L[1],D=Object(k.g)();function A(e){return J.apply(this,arguments)}function J(){return(J=Object(u.a)(l.a.mark((function e(t){var n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api_v1/rooms/".concat(t.target.value,"/"));case 2:return n=e.sent,e.next=5,n.json();case 5:s=e.sent,console.log("currentRoom",s),R(s),i(s.messages);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(s.useEffect)((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/rest-auth/user");case 2:e.sent.ok?P(!0):P(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[D]),Object(s.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api_v1/rooms/");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,console.log("rooms",n),a(n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var _=function(e){console.warn(e)},X=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(t)},e.next=3,fetch("/rest-auth/registration/",n).catch(_);case 3:if(!0!==!(s=e.sent)){e.next=8;break}console.warn(s),e.next=12;break;case 8:return e.next=10,s.json();case 10:a=e.sent,h.a.set("Authorization","Token ".concat(a.key));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,s,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(t)},e.next=3,fetch("/rest-auth/login/",n).catch(_);case 3:if(!0!==!(s=e.sent)){e.next=8;break}console.warn(s),e.next=12;break;case 8:return e.next=10,s.json();case 10:a=e.sent,h.a.set("Authorization","Token ".concat(a.key));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function M(){return(M=Object(u.a)(l.a.mark((function e(t){var n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":h.a.get("csrftoken")},body:JSON.stringify(x)},e.next=3,fetch("/rest-auth/logout/",n);case 3:if(s=e.sent){e.next=8;break}console.log(s),e.next=15;break;case 8:return console.log(s),e.next=11,s.json();case 11:e.sent,h.a.remove("Authorization"),P(!1),D.push("/login");case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(m.jsxs)("div",{className:"chatApp",children:[Object(m.jsx)("nav",{className:"nav-bar",children:Object(m.jsx)("button",{onClick:function(e){return M.apply(this,arguments)},children:"Logout"})}),Object(m.jsx)(N,{}),Object(m.jsxs)(k.d,{children:[Object(m.jsx)(k.b,{exact:!0,path:"/",children:Object(m.jsx)(k.a,{to:"/register"})}),Object(m.jsx)(k.b,{path:"/register",children:Object(m.jsx)(y,{user:x,setUser:g,handleRegistration:X,handleError:_})}),Object(m.jsx)(k.b,{path:"/login",children:Object(m.jsx)(w,{handleLogin:q,history:D})}),Object(m.jsx)(k.b,{path:"/chat",children:Object(m.jsxs)("div",{className:"app-container",children:[Object(m.jsxs)("section",{className:"room-list-container",children:[Object(m.jsx)(b,{roomList:n,fetchMessagesForThatRoom:A,isAuth:E}),Object(m.jsx)(f,{roomList:n,setRoomList:a,fetchMessagesForThatRoom:A,setCurrentRoom:R,isAuth:E})]}),Object(m.jsxs)("section",{className:"message-list-container",children:[Object(m.jsx)(O,{messageList:o,roomList:n,room:T.id,currentRoom:T,isAuth:E}),Object(m.jsx)(v,{currentRoom:T,messageList:o,setMessageList:i,roomList:n,isAuth:E})]})]})}),Object(m.jsx)(k.b,{})]})]})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,41)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),r(e),c(e)}))};c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(o.a,{children:Object(m.jsx)(S,{})})}),document.getElementById("root")),C()}},[[40,1,2]]]);
//# sourceMappingURL=main.60f8dfb8.chunk.js.map